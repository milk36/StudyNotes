# Pinus框架源码笔记

## 目录

- [Pinus框架源码笔记](#pinus框架源码笔记)
  - [目录](#目录)
  - [启动逻辑](#启动逻辑)
    - [pinus启动指令](#pinus启动指令)
    - [启动本地服务](#启动本地服务)

## 启动逻辑

### pinus启动指令

- 启动 master 节点 `pinus start --id master`
- 根据服务器类型启动节点 `pinus start --type chat`
- 启动指定 id 的服务器 `pinus start --id chat-server
-1`
- 以守护进程的方式启动服务器 `pinus start --type time -D` 
  - 如果开启了daemon，那么进程将转入后台运行, 所有的日志将不再打印到console上，只能通过对应的日志文件查看日志。
- 设置启动环境 `pinus start -e production`; 默认为 `development`

### 启动本地服务

- `constants.ts -> ServerInfo` 服务器信息接口
- `starter.ts`

  ```ts
  export function run(){
    if (utils.isLocal(server.host)) {
      // 启动本地服务
      ...
      localrun(process.execPath, null, options, cb);
    } else {
      // 启动远程服务
      ...
      sshrun(cmd, server.host, cb);
    }
  }
  ```
