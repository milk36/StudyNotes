skynet基础API
---
## 服务别名
> 每个服务启动之后，都有一个整形数来表示id，也可以使用字符串id来表示，例如：:01000010，其实就是把id：0x01000010转换成字符串。
> 
> 但是这个数字的表示方式会根据服务的启动先后顺序而变化，不是一个固定的值。如果想要方便的获取某个服务，那么可以通过给服务设置别名来。
### 本地别名与全局别名
在skynet中，服务别名可以分为两种：

* 一种是本地别名，本地别名只能在当前skynet节点使用，本地别名必须使用`.` 开头，例如：`.testalias`

* 一种是全局别名，全局别名可以在所有skynet中使用，全局别名不能以`.` 开头， 例如：`testalias`
### 别名注册与查询接口
> 注意：本地别名与全局别名可以同时存在
* 注册/指定别名
    ```lua
    local skynet = require "skynet"
    require "skynet.manager"
    ​
    --给当前服务定一个别名，可以是全局别名，也可以是本地别名
    skynet.register(aliasname)
    ​
    --给指定servicehandler的服务定一个别名，可以是全局别名，也可以是本地别名
    skynet.name(aliasname, servicehandler)
    ```
* 查询别名 本地/全局 两种方式
    ```lua
    --查询本地别名为aliasname的服务，返回servicehandler，不存在就返回nil
    skynet.localname(aliasname)
    ​   
    --[[
        查询别名为aliasname的服务,可以是全局别名也可以是本地别名，
        1、当查询本地别名时，返回servicehandler，不存在就返回nil
        2、当查询全局别名时，返回servicehandler，不存在就阻塞等待到该服务初始化完成
    --]]

    local skynet = require "skynet.harbor"
    harbor.queryname(aliasname)
    ```
* `7-testaliasname` 定义别名
    ```lua
    local skynet = require "skynet"
    require "skynet.manager"
    local harbor = require "skynet.harbor"

    skynet.start(function()
        local handle = skynet.newservice("1-test")

        skynet.name(".localalias",handle) --定义服务本地别名
        skynet.name("globalalias",handle) --定义服务全局别名    
    end)
    ```
* `8-testaliasquery`通过别名查询服务
    ```lua
    local skynet = require "skynet"
    require "skynet.manager"
    local harbor = require "skynet.harbor"

    skynet.start(function()    

        handle = skynet.localname(".localalias")
        skynet.error("localname .localalias handle", skynet.address(handle))
        
        handle = skynet.localname("globalalias") --只能查本地, 不能查全局
        skynet.error("localname globalalias handle", skynet.address(handle))

        handle = harbor.queryname(".localalias")
        skynet.error("queryname .localalias handle", skynet.address(handle))

        handle = harbor.queryname("globalalias") --如果全局别名不存在, 那么这个时候调用函数
        skynet.error("queryname globalalias handle", skynet.address(handle))
    end)
    ```
* 输出结果
    ```sh
    6-testalias
    [:01000010] LAUNCH snlua 6-testalias
    [:01000012] LAUNCH snlua 1-test
    [:01000012] server init
    [:01000012] 第一个skynet服务启动成功!
    [:01000010] localname .localalias handle :01000012
    [:01000010] localname globalalias handle nil #skynet.localname只能查本地, 不能查全局
    [:01000010] queryname .localalias handle :01000012
    [:01000010] queryname globalalias handle :01000012 #harbor.queryname如查不到全局名, 函数将一直阻塞
    ```
### 全局唯一服务名 与 全局别名的区别
<big>全局唯一服名称</big>: 是用来标识服务是唯一的，服务名称一般就是脚本名称，无法更改。

<big>全局别名</big>: 是用来给服务起别名的，既可以给普通服起别名，也可以给全局唯一服起别名。

他们两种名字是在不同的体系中的，有各种的起名字的方式，以及查询的方式。

所以不要尝试用`skynet.queryservice`查询一个全局别名，也不要尝试使用`harbor.queryname`去查询一个全局唯一服。
